<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Loan Application Form</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="container mt-5">

<div class="card shadow p-4">
    <h2 class="mb-4 text-primary">Loan Application Form</h2>

    <form th:action="@{/loan/submit}" th:object="${loan}" method="post">

        <!-- Application ID -->
        <div class="row mb-3" th:if="*{appId} != null">
            <div class="col-md-6">
                <label class="form-label">Application ID</label>
                <input type="text" th:field="*{appId}" class="form-control" readonly>
            </div>
        </div>
        <!-- Hidden input only if appId is new -->
        <input type="hidden" th:if="*{appId} == null" th:field="*{appId}">

        <!-- Applicant Info -->
        <div class="row mb-3">
            <div class="col-md-6">
                <label class="form-label">Applicant Name</label>
                <input type="text" th:field="*{applicantName}" class="form-control" required>
            </div>
            <div class="col-md-6">
                <label class="form-label">Date of Birth</label>
                <input type="date" th:field="*{dateOfBirth}" class="form-control" required>
            </div>
        </div>

        <!-- Identity -->
        <div class="row mb-3">
            <div class="col-md-4">
                <label class="form-label">PAN Number</label>
                <input type="text" th:field="*{panNumber}" class="form-control" required>
            </div>
            <div class="col-md-4">
                <label class="form-label">Aadhaar Number</label>
                <input type="text" th:field="*{aadhaarNumber}" class="form-control">
            </div>
            <div class="col-md-4">
                <label class="form-label">Phone</label>
                <input type="text" th:field="*{phone}" class="form-control" required>
            </div>
        </div>

        <!-- Contact -->
        <div class="row mb-3">
            <div class="col-md-6">
                <label class="form-label">Email</label>
                <input type="email" th:field="*{email}" class="form-control" required>
            </div>
            <div class="col-md-6">
                <label class="form-label">Address</label>
                <textarea th:field="*{address}" class="form-control" rows="1" required></textarea>
            </div>
        </div>

        <!-- Employment -->
        <div class="row mb-3">
            <div class="col-md-4">
                <label class="form-label">Employment Type</label>
                <select th:field="*{employmentType}" class="form-select" required>
                    <option value="" th:if="*{employmentType} == null" disabled selected>Select type</option>
                    <option value="Salaried">Salaried</option>
                    <option value="Self-Employed">Self-Employed</option>
                    <option value="Business">Business</option>
                </select>
            </div>
            <div class="col-md-4">
                <label class="form-label">Monthly Income</label>
                <input type="number" th:field="*{income}" class="form-control" step="0.01" required>
            </div>
            <div class="col-md-4">
                <label class="form-label">Loan Amount</label>
                <input type="number" th:field="*{loanAmount}" class="form-control" step="0.01" required>
            </div>
        </div>

        <!-- Loan Details -->
        <div class="row mb-3">
            <div class="col-md-6">
                <label class="form-label">Loan Tenure (Months)</label>
                <input type="number" th:field="*{loanTenureMonths}" class="form-control" required>
            </div>
            <div class="col-md-6">
                <label class="form-label">Credit Score</label>
                <input type="number" th:field="*{creditScore}" class="form-control" min="300" max="900">
            </div>
        </div>

        <!-- Decision (only after Drools evaluation) -->
        <div class="row mb-3" th:if="*{decision} != null">
            <div class="col-md-6">
                <label class="form-label">Decision (Generated by System)</label>
                <input type="text" th:field="*{decision}" class="form-control" readonly>
            </div>
        </div>

        <!-- Actions -->
        <div class="mt-4">
            <button type="submit" class="btn btn-primary">Submit Application</button>
            <a href="/loan/all" class="btn btn-outline-secondary">View All Applications</a>
        </div>
    </form>
</div>

<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <a class="btn btn-secondary" href="/user/dashboard">‚Üê Dashboard</a>
    </div>
</div>

</body>
</html>
